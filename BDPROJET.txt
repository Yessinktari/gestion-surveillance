USE bdprojetgl;


-- --- Ajouter un nouvel enseignant ---
INSERT INTO enseignant (id, nom, prenom, email, password, section, tel, grade) VALUES
(3, 'Ben Ali', 'Amir', 'amir.benali@mail.tn', 'amir123', 'Informatique', '25810000', 2);

-- --- Associer ce nouvel enseignant à des matières ---
INSERT INTO Enseignant_matieres_enseignees (enseignant_id, matieres_enseignees_id) VALUES
(3, 'ConceptionOO'),
(3, 'Systèmes d’Information');

-- --- Associer ce nouvel enseignant à des séances ---
-- Par exemple, on l’affecte aux séances 1 et 3
INSERT INTO enseignant_seances (enseignant_id, seances_id) VALUES
(3, 1),
(3, 3);

-- --- Mettre à jour le nombre d’enseignants affectés pour chaque séance ---
UPDATE Seance s
JOIN (
    SELECT seances_id, COUNT(*) AS nb_enseignants
    FROM Enseignant_Seances
    GROUP BY seances_id
) es ON s.id = es.seances_id
SET s.enseignants_affectés = es.nb_enseignants;

-- --- Optionnel : recalculer limite enseignants si les matières de certaines séances ont changé ---
UPDATE Seance s
JOIN (
    SELECT seance, SUM(nb_paquets) AS total_paquets
    FROM Matiere
    GROUP BY seance
) m ON s.id = m.seance	
SET s.limite_enseignants = m.total_paquets;

